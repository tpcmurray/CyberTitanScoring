using System;
using System.Collections.Generic;
using System.Runtime.CompilerServices;
using System.Text;
using WindowsApis;

namespace VulnerabilityTracker.Vulnerabilities
{
    public class UserShouldNotBeAdmin : AbstractVulnerability
    {
        public override bool IsFixed()
        {
            return Users.IsUserAdmin(UserName());
        }

        public override bool CreateVulnerability()
        {
            if (Users.IsUserExisting(UserName())) Users.DeleteUser(UserName());
            Users.CreateAdminUser(UserName(), "CyberTitan1234567!@#$%^&");
            return true;
        }

        public override bool RemoveVulnerability()
        {
            if (Users.IsUserExisting(UserName())) Users.DeleteUser(UserName());
            Users.CreateNonAdminUser(UserName(), "CyberTitan1234567!@#$%^&");
            return true;
        }

        private string UserName()
        {
            return Properties["username"].ToString();
        }
    }
}