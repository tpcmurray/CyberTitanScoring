using WindowsApis;

namespace VulnerabilityTracker
{
    internal class UserIsMissing : AbstractVulnerability
    {
        public override bool IsFixed()
        {
            return Users.IsUserExisting(UserName());
        }

        public override bool CreateVulnerability()
        {
            if (Users.IsUserExisting(UserName())) Users.DeleteUser(UserName());
            return true;
        }

        public override bool RemoveVulnerability()
        {
            if (Users.IsUserExisting(UserName())) Users.DeleteUser(UserName());
            Users.CreateNonAdminUser(UserName(), "CyberTitan1234567!@#$%^&");
            return true;
        }

        private string UserName()
        {
            return Properties["username"].ToString();
        }
    }
}